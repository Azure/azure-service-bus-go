language: go
sudo: required
go:
- 1.x
- 1.9.x
before_install:
- go get github.com/mattn/goveralls
- go get golang.org/x/tools/cmd/cover
- go get github.com/fzipp/gocyclo
- go get github.com/golang/dep/cmd/dep
- go get honnef.co/go/tools/cmd/megacheck
- go get -u golang.org/x/lint/golint
- wget https://releases.hashicorp.com/terraform/0.11.8/terraform_0.11.8_linux_amd64.zip
- unzip terraform_0.11.8_linux_amd64.zip
- sudo mv ./terraform /usr/local/bin
- echo "deb [arch=amd64] https://packages.microsoft.com/repos/azure-cli/ $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/azure-cli.list
- curl -L https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -
- sudo apt-get update
- sudo apt-get install apt-transport-https azure-cli
jobs:
  include:
  - stage: integration tests
    if: type IN (push, cron)
    env:
    - secure: ICMOA9w6LOwBsEGpvigFxZbAA0DAbjFssGpsSnPQ3SA6uF5wPa90jjj6eiu+bbjJ94MQQuprmHRy593yzkCzZN98XcQZuQ6jlvqpsQsF+EN+xlCLeGqjAMIrRv5Bs+behiHe4cme6TA9AtCn4FDu4aDtl6sg5SJ/Q9MqDSFkeJoRgzNonGYaHneD22NGTyb//MPb2fWLl6SLhsC84aZf9W3nQnfH2H38c7e9eqDHwMjxoRzwyeca6VxTeFMGQsAF1ypoDMz3Nc6Owv3ZVet++2N46wqrxp9owi1XR3L2ipWP1meIu092XXnt6Tz1y4oMBEK/swHsO9bB7roPW5EJzZOW74gTKyJaiH1iM41RhuiOCXALduVg030r7FH5DXcfK9/CflE4S7wOY6ARSqLX2aNraypNMpw7Ap10TaZXVbtsMhrY/EI34g1hBi8AlS/GQHf++PNp/lov8SOV16LKRSZyonAFmWRFGwfQcQ5WaV1j2ykGvC9Q7iEjaitcUZ7GfVNPiIZk2ziKWpudBE3hvkXX2nC58RwrHBbvcXirZ911YURwnz8c85utuWOhXZLrRTYzo/1NDsO7JLKaQENHP4yZChre1wO5uCv8TJg9u6tHVO7emDjwZthhABr93T8m1GDbjILS9N2AMlPM0xiNynbibrhRQyj2ROi3wD6k6zk=
    - secure: Vqc4MVDEM8MkG5e/bIArkbmjiDNK2RVCDu9WCINypuCw9bYt4UZ/3gACAsgBHrBzO1x9ctoBZawcMs1zamWw6gwmWk7ukrHbSXop3M+YkxRR46phj2AgqKyPeYYhcbJcgFRYyf6OZbdHTREAteW9Fi7347CGkq6V0fzbjjLqSbARL18fzYRZSWvCfHD4TOwyfsI3kmaU99sWtaNEfewCkdqr3bWjTmWbHTL9A6Qhzchxa4HtB1QyGICLwHi/30UxQq2RhD8OSS3m3ZWFfW1OezbZz/XEc3GN1jl7cpf8RLWLEThEW9RI5mnJZdTeDOSEYINAweRWQJMGpsGgHmZ2tJNA2lydtnA9Xkn/bxEfdcWhfYVP0IUv4VkL1ClbI+SMnss4JTuAyB63iEVjAJGLhfIMjeg1z4ctPEpely2qI8nSbXirs4mT/vCxtn1c3iaKpIExmshUUcQbkD919qVnK0M4mFeoGb74B5EUTe/DgbD+NYgT5VS6R/XI8GNEfoUWMYedd2rk4LD30lL6enDQOaxxKSRePwR7yCvRfHHo0hLVd51/27n8f6X4y96GjDEm0Q/kpF3tCMWZdNOno8dPEcrDhek9Pd3+pICkISHurK7IYcf1QZUQ5blTlFFiL7qwf4s8coZE53hfs8phinxLTIftG1yP+W2PvwyUZISkUUI=
    - secure: PqQeVgo6L+EG08mXCgviu5D5ePc1KjvUbCsiZkS88QBS4FssQswdHI/8mGNvA+BqCVomXCdwMvZIUSPAd6kSQiJaM4HTf5rbW/Y8rDT1irU1lAempbSCG89QqrSiYQNfgqPRctIdnAP6nKEYgNtPlLZrquO9fN2gpwx+HFcaxGjde5fHORVj46oJBJL4llk6ZOpoz5wK1BhWL6s1zo1rssCRl/MQtMwKi8KFckY62qp2uJtKBG10FxQfl5BCKOz3crQfWHbetBNsZNUOfiIKJJ0HUC4Zvrg8Gg0vfc+YYuHCXCJykzkNUH8hprf7sPuN/i7Di5PdjigVLDsxrlNQevANE5544yOsdF0rM4J/aJQWHlh1ztM3Mmoxh1W3XoMCv7naqg61bsHxXzOUTMTYlhKijjAQmUJ47BnGgH11CFFhBaw+y8jvS1qAGnOGhDVQy/OSB0WBPt9aUFpUyyJqGKIDlMkv8epMHU1qq3nmtWyJWZ9p1pc5ru4klA3eifCzk8SJBSTMVV7p4qHUVf/WZpisgMAT2ABJxta1cDqXu1EpwgnC8AKIpbQmuxus10m1zUKC0Q3SmqotHr+67h17JDTvLSnOkINLn+JPq5K9kq28FPQxdnkBZQTSNZi/fq/rKitKoVdWnjhMDk+k+o6vwkbrkUX3n4lBWxbJNCDwgwA=
    - secure: edUBlEkv7opAMPFkugmYvnaNSNJ/wRcULHmPB7zqPLnQaJxAdlr7QqVifiWOGaC5S7bxw8NifO85cfHPtTScuCLLIg6zE/YuQuZ4AOmeIX5k+111Mdlzyy7TFGr4PA/6NoxqEHM7FD2ILL/5MVME7i4zYT8XRB9t1sCCV2zOMqvkNkdN8aAHpYrHc2CSzLegjN4APlmQQlISx0+f0SbcCwIGGDciOVR65Qq9sDTOWSfv1BV2otKxrxH6kBXqggNrstJ4EDKsamlp2Zmf25RXn48u3TbeNaWU825XzG3kQxbYUlsl49kjxOdoXnrPDqB0gHSIWeZPpBGsxdmgYg1m/ubh8Sybg0+CiYpYk3h9TualDep2S+F3yJpmfWip+3LZYbK4yoXnypltBdyyrygt2dZ4LyUQoeuiA5iaBRBixj37ZyIUGO7ruij3k4GBvtXtQ5/YCre7sw0NhfO1jGnp7LybWBuTqYy6rqyPStmdw5TNWIWNclLWChp/foDSVwnNidYfsIpzsJwWFXezNI5CPwjQoNk72bq+63k36u5xxO+C8PYGdAvOZNTDVkeLYPv6kaelQB30OHPQBuDlL344PqezCKy9XGX+6xCr+N9ZZOsSBV5Rf4+T5h1BJsLv36VYT4H9F9v/Vo3wc93s831mZyDppfUxUOCiuPEKdG4A5ps=
    - secure: b7QFVNJ+13JuuFuvvebsborLD+T6FEBlBDK7vYUYQb/vA4xcgvTNWs8PmsUEZKgMBgCAerkLQvYy1m69XRPJfimF/iYLuEDF49cgOubg3RO8heyH/o51/J//BA6EU0zbLho6HEdz2z8PMffQE6bvecLd4VI0pAdfzX4r3mbbqpfLtkSyOBmLDrHGIq/u+xAJOusR44SFNLUrnrFi9j2mCFCnEMxcdIeGj2ix7ZDYViO/9rxWvrKNi/cWj48J3CLGiDDrna36ckHAqTpqsFjIPYnfAI/S1SM+S/IGqCvZO4ztmJw/LXUB8jMcVPyi80H7YZy583RXtcIHsx4bptCuYnhFXRFAky3lC3Bj8dPagMlSWAyOu5W3jfs01VE9LMcTn1SVvqkQczgc2+xFOtfbUuWQlCRzvpaPhd7ViSKrBN3X2y4+ph+h1IsIT3Nq6zQQYfkdYO0MifydRFKemoid43OZ8S2U55EDkrknCMDdy1khf94QlUVKbRSaCuw9OT5qiojJDW9HeKQHwc6XdxCkQtTI94XaBj4jMpLFd/sw6MmXdzUC2FB/XJZvO1RvOSUeK2FPWQaTbSkypbrBastb5hiF5SG1SX7kVcfgr6vHFS099A9U8qbgbdXO7Hku1rhK9f8fPInt261roWPg161OHAcOcqruzSWkFDX5+adrEMc=
    script:
    - az login --tenant $AZURE_TENANT_ID --service-principal --username $AZURE_CLIENT_ID --password $AZURE_CLIENT_SECRET
    - make test-cover
    - goveralls -coverprofile=cover.out -service=travis-ci
script:
- make